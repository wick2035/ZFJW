# 方正教务系统成绩分项下载器

![版本](https://img.shields.io/badge/版本-v2.0-blue.svg)
![支持](https://img.shields.io/badge/支持-方正教务系统-green.svg)
![许可证](https://img.shields.io/badge/许可证-MIT-yellow.svg)

## 📋 项目简介

本项目是一个用户脚本，用于在方正教务系统的成绩查询页面添加"导出所有成绩"功能，可以下载包含**平时分等详细分项**的 Excel 成绩单。

相比系统原生的导出功能，本工具可以获取到更详细的成绩分项信息，包括：
- 课程基本信息（课程名称、学年、学期、开课学院等）
- 详细成绩分项（平时分、期中成绩、期末成绩等）
- 完整的成绩构成信息

## 🎯 支持的教务系统

已测试支持以下学校的方正教务系统：


*理论上支持所有使用方正教务系统的学校*

## 🚀 安装使用教程

### 方式一：使用脚本猫（推荐）

#### 1. 安装脚本猫扩展

**Chrome 浏览器：**
1. 打开 [Chrome 网上应用店](https://chrome.google.com/webstore/category/extensions)
2. 搜索"脚本猫"或直接访问脚本猫的商店页面
3. 点击"添加至 Chrome"进行安装

**Edge 浏览器：**
1. 打开 [Microsoft Edge 扩展商店](https://microsoftedge.microsoft.com/addons/)
2. 搜索"脚本猫"
3. 点击"获取"进行安装

**Firefox 浏览器：**
1. 打开 [Firefox 附加组件商店](https://addons.mozilla.org/)
2. 搜索"脚本猫"
3. 点击"添加到 Firefox"

#### 2. 安装用户脚本

1. 安装完脚本猫后，浏览器工具栏会出现脚本猫图标
2. 下载本项目的 `main.js` 文件
3. 点击脚本猫图标，选择"添加脚本"
4. 将 `main.js` 文件内容复制粘贴到编辑器中
5. 点击"保存"完成安装

#### 3. 使用脚本

1. 登录你的学校教务系统
2. 进入"成绩查询"页面
3. 选择要查询的学年和学期
4. 页面会自动出现"导出所有成绩"按钮
5. 点击按钮即可下载包含详细分项的 Excel 文件

### 方式二：使用其他脚本管理器

本脚本同样支持：
- **Tampermonkey**（油猴脚本）
- **Greasemonkey**
- **Violentmonkey**（暴力猴）

安装方法类似，将脚本内容添加到对应的脚本管理器即可。

## ⚙️ 技术原理

### API 接口说明

**请求 URL：**
```
{教务系统域名}/jwglxt/cjcx/cjcx_dcXsKccjList.html
```

**请求方式：**
- POST 请求
- 需要携带登录后的 Cookie

**请求参数：**
```javascript
[
    ['gnmkdmKey', 'N305005'],
    ['xnm', xnm],                    // 学年号
    ['xqm', xqm],                    // 学期号  
    ['dcclbh', 'JW_N305005_GLY'],
    ...exportColumns.map(col => ['exportModel.selectCol', col]),
    ['exportModel.exportWjgs', 'xls'],
    ['fileName', '成绩单']
]
```

**导出字段：**
- `kcmc` - 课程名称
- `xnmmc` - 学年
- `xqmmc` - 学期
- `kkbmmc` - 开课学院
- `kch` - 课程代码
- `jxbmc` - 教学班
- `xf` - 学分
- `xmcj` - 成绩
- `xmblmc` - 成绩分项

## 🔧 自定义配置

如果你的学校教务系统地址不在支持列表中，可以手动修改脚本：

1. 找到脚本中的 `@match` 行
2. 添加你学校的教务系统域名：
```javascript
// @match        *://你的学校域名/jwglxt/cjcx/*
```
3. 保存脚本即可

## ❓ 常见问题

**Q: 点击按钮没有反应？**
A: 请确保已经登录教务系统，并且在成绩查询页面选择了学年和学期。

**Q: 下载的文件打不开？**
A: 下载的是 Excel 格式文件，请使用 Microsoft Excel、WPS 或其他支持的软件打开。

**Q: 提示网络错误？**
A: 请检查网络连接，确保教务系统服务正常。

**Q: 我的学校不在支持列表中？**
A: 可以尝试按照自定义配置部分的说明进行配置，大部分方正教务系统都可以支持。

## 📝 更新日志

- **v1.3** - 优化错误处理，增加更多学校支持
- **v1.2** - 修复部分学校兼容性问题
- **v1.1** - 添加文件下载功能优化
- **v1.0** - 初始版本发布

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

如果你的学校也使用方正教务系统且脚本工作正常，欢迎在 Issue 中提供学校信息，我们会添加到支持列表中。

## 📄 许可证

本项目基于 MIT 许可证开源。

## 🏷️ 关键词

`平时分查询` `方正教务系统` `成绩导出` `用户脚本` `脚本猫` `教务系统` `成绩分项`
